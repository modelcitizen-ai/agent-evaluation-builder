"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[845],{781:(e,t,s)=>{function r(e,t,s,r){let a=s.length>0?Object.keys(s[0]):[],n=r.map(e=>e.name);return{evaluationId:e,evaluationName:t,lastUpdated:new Date().toISOString(),results:[],columns:{original:a,responses:n}}}function a(e,t){return{...e,lastUpdated:new Date().toISOString(),results:[...e.results,t]}}function n(e){try{return JSON.parse(localStorage.getItem("resultsDatasets")||"{}")[e]||null}catch(e){return console.error("Error retrieving results dataset:",e),null}}function o(e){try{let t=JSON.parse(localStorage.getItem("resultsDatasets")||"{}");t[e.evaluationId]=e,localStorage.setItem("resultsDatasets",JSON.stringify(t))}catch(e){console.error("Error saving results dataset:",e)}}s.d(t,{ST:()=>r,aU:()=>a,dQ:()=>n,zw:()=>o})},2845:(e,t,s)=>{s.r(t),s.d(t,{default:()=>v});var r=s(5155),a=s(2115),n=s(5695);let o=a.forwardRef(function(e,t){let{title:s,titleId:r,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},n),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12a7.5 7.5 0 0 0 15 0m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m16.5 0H21m-1.5 0H12m-8.457 3.077 1.41-.513m14.095-5.13 1.41-.513M5.106 17.785l1.15-.964m11.49-9.642 1.149-.964M7.501 19.795l.75-1.3m7.5-12.99.75-1.3m-6.063 16.658.26-1.477m2.605-14.772.26-1.477m0 17.726-.26-1.477M10.698 4.614l-.26-1.477M16.5 19.794l-.75-1.299M7.5 4.205 12 12m6.894 5.785-1.149-.964M6.256 7.178l-1.15-.964m15.352 8.864-1.41-.513M4.954 9.435l-1.41-.514M12.002 12l-3.75 6.495"}))});var l=s(5628);let i=a.forwardRef(function(e,t){let{title:s,titleId:r,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},n),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))}),d=a.forwardRef(function(e,t){let{title:s,titleId:r,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},n),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}),c=a.forwardRef(function(e,t){let{title:s,titleId:r,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},n),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}),u=a.forwardRef(function(e,t){let{title:s,titleId:r,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},n),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))});var m=s(9416),g=s(8112),x=s(4500);function h(e){var t,s;let{metric:n,metrics:o,isOpen:l,onClose:i,onSave:d}=e,[c,m]=(0,a.useState)(null);if((0,a.useEffect)(()=>{n&&m({...n})},[n]),!l||!c)return null;let g=(e,t)=>{let s=[...c.options];s[e]=t,m({...c,options:s})},h=(e,t)=>{let s={...c.likertLabels,[e]:t};m({...c,likertLabels:s})},p=e=>{let t=[...c.options];t.splice(e,1),m({...c,options:t})};return(0,r.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:i}),(0,r.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,r.jsxs)("div",{className:"bg-white px-6 pt-6 pb-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:n&&(null==o?void 0:o.some(e=>e.id===n.id))?"Edit Question":"Add a Question"}),(0,r.jsx)("button",{onClick:i,className:"text-gray-400 hover:text-gray-500",children:(0,r.jsx)(x.A,{className:"h-6 w-6"})})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-3",children:"Name"}),(0,r.jsx)("input",{type:"text",value:c.name,onChange:e=>{m({...c,name:e.target.value})},className:"block w-full border border-gray-300 rounded-md px-3 py-2 text-sm text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",placeholder:"Metric Name"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-3",children:"Type"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("select",{value:c.type,onChange:e=>{let t;let s=e.target.value,r=[];switch(s){case"yes-no":r=["Yes","No"];break;case"likert-scale":r=["1","2","3","4","5"],t=c.likertLabels||{low:"Low",high:"High"};break;case"custom-list":r=["Good","Fair","Poor"];break;case"text-input":r=[]}m({...c,type:s,options:r,likertLabels:t})},className:"block w-full border border-gray-300 rounded-md px-3 py-2 text-sm text-gray-900 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 appearance-none bg-white",children:[(0,r.jsx)("option",{value:"yes-no",children:"Yes/No"}),(0,r.jsx)("option",{value:"likert-scale",children:"Likert Scale"}),(0,r.jsx)("option",{value:"custom-list",children:"Custom List"}),(0,r.jsx)("option",{value:"text-input",children:"Text Input"})]}),(0,r.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-4 pointer-events-none",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]}),"likert-scale"===c.type&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-3",children:"Scale Labels"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Low End"}),(0,r.jsx)("input",{type:"text",value:(null===(t=c.likertLabels)||void 0===t?void 0:t.low)||"",onChange:e=>h("low",e.target.value),className:"block w-full border border-gray-300 rounded-md px-3 py-2 text-sm text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",placeholder:"Low"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"High End"}),(0,r.jsx)("input",{type:"text",value:(null===(s=c.likertLabels)||void 0===s?void 0:s.high)||"",onChange:e=>h("high",e.target.value),className:"block w-full border border-gray-300 rounded-md px-3 py-2 text-sm text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",placeholder:"High"})]})]})]}),"custom-list"===c.type&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-3",children:"Options"}),(0,r.jsxs)("div",{className:"space-y-3",children:[c.options.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("input",{type:"text",value:e,onChange:e=>g(t,e.target.value),className:"flex-1 border border-gray-300 rounded-md px-3 py-2 text-sm text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",placeholder:"Option ".concat(t+1)}),(0,r.jsx)("button",{onClick:()=>p(t),className:"flex-shrink-0 w-8 h-8 border border-gray-300 rounded-md flex items-center justify-center text-gray-400 hover:text-gray-600 hover:border-gray-400 transition-colors",children:(0,r.jsx)(x.A,{className:"h-5 w-5"})})]},t)),(0,r.jsx)("button",{onClick:()=>{m({...c,options:[...c.options,"New Option"]})},className:"w-8 h-8 border border-gray-300 rounded-md flex items-center justify-center text-gray-400 hover:text-gray-600 hover:border-gray-400 transition-colors",children:(0,r.jsx)(u,{className:"h-6 w-6"})})]})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"metric-required",checked:c.required,onChange:e=>{m({...c,required:e.target.checked})},className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),(0,r.jsx)("label",{htmlFor:"metric-required",className:"ml-3 block text-sm text-gray-900",children:"Required"})]})]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 px-6 py-4 sm:flex sm:flex-row-reverse",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{d(c)},className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Save"}),(0,r.jsx)("button",{type:"button",onClick:i,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})}var p=s(7489),f=s(4958),y=s(3247),b=s(781);function v(){let e=(0,n.useRouter)(),t=(0,n.useParams)(),s=(null==t?void 0:t.id)!==void 0,x=(null==t?void 0:t.id)?Number(t.id):null,[v,w]=(0,a.useState)(1),[j,N]=(0,a.useState)({}),[k,S]=(0,a.useState)(!1),[C,E]=(0,a.useState)(null),[L,M]=(0,a.useState)(!1),[I,O]=(0,a.useState)(null),[R,_]=(0,a.useState)(null),[A,q]=(0,a.useState)(!1),[D,W]=(0,a.useState)(!1),[F,z]=(0,a.useState)(!1),[J,H]=(0,a.useState)(null),[B,P]=(0,a.useState)(50),[T,Q]=(0,a.useState)(!1),U=(0,a.useRef)(null),[Y,G]=(0,a.useState)([]),[K,V]=(0,a.useState)([]),[Z,X]=(0,a.useState)("Content Quality Assessment"),[$,ee]=(0,a.useState)(!1),[et,es]=(0,a.useState)("Please evaluate each response carefully. Focus on quality, relevance, accuracy, and appropriateness of the generated content."),[er,ea]=(0,a.useState)([{id:1,name:"Overall Quality",type:"likert-scale",options:["1","2","3","4","5"],required:!0,likertLabels:{low:"Poor",high:"Excellent"},aiGenerated:!1},{id:2,name:"Is the content appropriate and accurate?",type:"yes-no",options:["Yes","No"],required:!0,aiGenerated:!1},{id:3,name:"Additional Comments",type:"text-input",options:[],required:!1,aiGenerated:!1}]),[en,eo]=(0,a.useState)([{id:"user_query",name:"user_query",suggestedRole:"Input Data",confidence:85,reason:"Contains user queries/prompts for AI evaluation",userRole:"Input Data"},{id:"ai_response",name:"ai_response",suggestedRole:"Model Output",confidence:90,reason:"Contains AI responses that need human evaluation",userRole:"Model Output"},{id:"category",name:"category",suggestedRole:"Metadata",confidence:80,reason:"Categorical field providing context for analysis",userRole:"Metadata"},{id:"item_id",name:"item_id",suggestedRole:"Metadata",confidence:90,reason:"Identifier field providing context but not directly used for evaluation",userRole:"Metadata"}]),[el,ei]=(0,a.useState)(!0),[ed,ec]=(0,a.useState)(!1),[eu,em]=(0,a.useState)({}),[eg,ex]=(0,a.useState)(1),[eh,ep]=(0,a.useState)(new Set),[ef,ey]=(0,a.useState)(!1),[eb,ev]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=e=>{(e.ctrlKey||e.metaKey)&&"z"===e.key&&!e.shiftKey&&(e.preventDefault(),e_())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[J,er]),(0,a.useLayoutEffect)(()=>{if(s&&x){let e=JSON.parse(localStorage.getItem("evaluations")||"[]").find(e=>e.id===x);e&&(X(e.name),ee(!1),es(e.instructions),ea(e.criteria),eo(e.columnRoles),G(e.data),e.data.length>0&&V(Object.keys(e.data[0])))}else{let e=sessionStorage.getItem("uploadedData"),t=sessionStorage.getItem("aiAnalysisResult"),s=sessionStorage.getItem("useAIAnalysis");if(e){let r=JSON.parse(e);if(G(r),r.length>0){let e=Object.keys(r[0]);V(e),t&&"true"===s?ew(JSON.parse(t)):eS(r,e)}}}},[s,x]);let ew=e=>{e.evaluationName&&!$&&X(e.evaluationName),e.instructions&&es(e.instructions),eo(e.columnAnalysis.map(e=>{let t=e.suggestedRole;return"Input Data"===e.suggestedRole&&(t="Input"),"Model Output"===e.suggestedRole&&(t="Model Output"),"Excluded Data"===e.suggestedRole&&(t="Excluded"),{id:e.columnName,name:e.columnName,suggestedRole:e.suggestedRole,confidence:e.confidence,reasoning:e.reasoning,reason:e.reasoning,userRole:t}})),ea(e.suggestedMetrics.map((e,t)=>({id:t+1,name:e.name,type:e.type,options:e.options,required:e.required,likertLabels:e.likertLabels,aiGenerated:!0})))};(0,a.useEffect)(()=>{let e=e=>{(e.ctrlKey||e.metaKey)&&"z"===e.key&&!e.shiftKey&&(e.preventDefault(),e_())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[J,er]),(0,a.useEffect)(()=>{let e=e=>{if(!T||!U.current)return;let t=U.current.getBoundingClientRect(),s=t.width,r=(e.clientX-t.left)/s*100;P(r=Math.max(30,Math.min(70,r)))},t=()=>{Q(!1)};return T&&(document.addEventListener("mousemove",e),document.addEventListener("mouseup",t)),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t)}},[T]);let ej=Y.length>0?Y:[{user_query:"How do I reset my password?",ai_response:"To reset your password, click on 'Forgot Password' on the login page and follow the instructions sent to your email.",category:"support",item_id:"item_001"},{user_query:"How do I reset my password?",ai_response:"You can reset your password by visiting our password reset page at example.com/reset and entering your email address.",category:"support",item_id:"item_002"},{user_query:"How do I reset my password?",ai_response:"Password reset is simple! Just go to the login page, click 'Forgot Password', and we'll send you a reset link via email within minutes.",category:"support",item_id:"item_003"},{user_query:"What are your business hours?",ai_response:"Our business hours are Monday through Friday, 9 AM to 6 PM EST. We're closed on weekends and major holidays.",category:"general",item_id:"item_004"},{user_query:"What are your business hours?",ai_response:"We're open Monday-Friday from 9 AM to 6 PM Eastern Time. Weekend and holiday hours may vary.",category:"general",item_id:"item_005"},{user_query:"What are your business hours?",ai_response:"Our team is available to help you Monday through Friday, 9:00 AM to 6:00 PM EST. We're closed weekends and on major holidays.",category:"general",item_id:"item_006"},{user_query:"Can I return an item after 30 days?",ai_response:"Our standard return policy is 30 days from purchase. However, you may still be eligible for store credit depending on the item condition.",category:"returns",item_id:"item_007"},{user_query:"Can I return an item after 30 days?",ai_response:"Returns are typically accepted within 30 days, but we can offer store credit for items in good condition beyond that timeframe.",category:"returns",item_id:"item_008"},{user_query:"Can I return an item after 30 days?",ai_response:"While our standard policy is 30 days, we understand that sometimes life gets in the way. Contact us and we'll work with you to find a solution, possibly including store credit.",category:"returns",item_id:"item_009"}],eN=e=>{let t=en.find(t=>t.name===e);return(null==t?void 0:t.displayName)&&t.displayName.trim()?t.displayName:e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())};(0,a.useEffect)(()=>{if(en.length>0&&!I&&!s&&!sessionStorage.getItem("aiAnalysisResult")&&!$){let e=en.find(e=>"Model Output"===e.userRole||"Model Output"===e.suggestedRole),t=en.find(e=>"Input"===e.userRole||"Input Data"===e.suggestedRole);if(e){let t=eN(e.name).replace(/response|output|generated|result|prediction/gi,"").trim();X(t?"".concat(t," Content Quality"):"Content Quality Assessment")}else if(t){let e=eN(t.name).replace(/content|text|data|input|query|prompt|question/gi,"").trim();X(e?"".concat(e," Content Evaluation"):"Content Quality Assessment")}}},[en,I,s,$]);let{analyzeFallback:ek}=(0,y.U)(),eS=(e,t)=>{try{var s;let r=ek(e,t),a=(s=r)&&s.success?{columnRoles:s.columnAnalysis.map(e=>{let t=e.suggestedRole;return"Input Data"===e.suggestedRole&&(t="Input"),"Model Output"===e.suggestedRole&&(t="Model Output"),"Excluded Data"===e.suggestedRole&&(t="Excluded"),"Metadata"===e.suggestedRole&&(t="Metadata"),{id:e.columnName,name:e.columnName,suggestedRole:e.suggestedRole,confidence:e.confidence,reasoning:e.reasoning,reason:e.reasoning,userRole:t}}),criteria:s.suggestedMetrics.map((e,t)=>({id:t+1,name:e.name,type:e.type,options:e.options,required:e.required,likertLabels:e.likertLabels,aiGenerated:!0})),evaluationName:s.evaluationName,instructions:s.instructions}:{columnRoles:[],criteria:[],evaluationName:"Content Quality Assessment",instructions:"Please evaluate each item carefully."};return eo(a.columnRoles),$||X(a.evaluationName),ea(a.criteria),es(a.instructions),r}catch(e){return console.error("Error in fallback analysis:",e),{success:!1,error:"Fallback analysis failed"}}},eC=er.every(e=>{if(!e.required)return!0;let t=j["criterion-".concat(e.id)];return null!=t&&""!==t.trim()}),eE=async e=>{if(e.preventDefault(),eC){if(S(!0),em({...eu,[v]:j}),await new Promise(e=>setTimeout(e,1e3)),S(!1),ep(new Set([...eh,v])),ev(!1),v>=eD())ey(!0);else{let e=v+1;w(e),ex(Math.max(eg,e))}}},eL=(e,t)=>{N(s=>({...s,["criterion-".concat(e)]:t})),ev(!0)},eM=(e,t)=>{eo(s=>s.map(s=>{if(s.id===e){let e=s.reason;if(s.suggestedRole!==t)switch(t){case"Input":e="Manually set as input data for evaluation";break;case"Model Output":e="Manually set as model output data for evaluation";break;case"Reference":e="Manually set as reference data for evaluation";break;case"Excluded":e="Manually excluded from evaluation (may contain labels or sensitive information)";break;case"Metadata":e="Manually set as metadata (provides context but not directly evaluated)"}return{...s,userRole:t,reason:e}}return s}))},eI=(e,t)=>{eo(s=>s.map(s=>s.id===e?{...s,displayName:t}:s))},eO=e=>{let t=er.find(t=>t.id===e);t&&(E(t),M(!0))},eR=e=>{let t=er.findIndex(t=>t.id===e);-1!==t&&(H({metric:er[t],index:t}),ea(er.filter(t=>t.id!==e)))},e_=()=>{if(!J)return;let e=[...er];e.splice(J.index,0,J.metric),ea(e),H(null)},eA=(e,t)=>{let s=er.findIndex(t=>t.id===e);if(-1===s||"up"===t&&0===s||"down"===t&&s===er.length-1)return;let r=[...er],a="up"===t?s-1:s+1;[r[s],r[a]]=[r[a],r[s]],ea(r)},eq=async()=>{z(!0);try{let t=JSON.parse(localStorage.getItem("evaluations")||"[]"),r=Y.length>0?Y:ej;if(s&&x){let e=t.map(e=>e.id===x?{...e,name:Z,instructions:et,criteria:er,columnRoles:en,data:r,totalItems:eD()}:e);localStorage.setItem("evaluations",JSON.stringify(e))}else{let e=Date.now(),s={id:e,name:Z,instructions:et,criteria:er,columnRoles:en,data:r,totalItems:eD(),status:"draft",createdAt:new Date().toISOString()};try{let e=await (0,f.Hg)(s);console.log("Evaluation created successfully:",e),t.unshift(s),localStorage.setItem("evaluations",JSON.stringify(t))}catch(e){console.error("Error creating evaluation in database:",e),console.log("Falling back to localStorage"),t.unshift(s),localStorage.setItem("evaluations",JSON.stringify(t))}let a=(0,b.ST)(e,Z,r,er);(0,b.zw)(a),sessionStorage.removeItem("uploadedData"),sessionStorage.removeItem("fileName"),sessionStorage.removeItem("aiAnalysisResult"),sessionStorage.removeItem("useAIAnalysis")}e.push("/data-scientist")}catch(e){console.error("Error saving evaluation:",e),alert("Error saving evaluation. Please try again.")}finally{z(!1)}};(0,a.useEffect)(()=>{N(eu[v]||{}),ev(!1),v>eg&&ex(v)},[v,eu,eg]);let eD=()=>{try{if(Y&&Y.length>0)return Y.length;return 20}catch(e){return console.error("Error in getTotalItems:",e),20}},eW=()=>{try{if(0===Y.length&&0===ej.length)return"No data available for preview.";let e=Y.length>0?Y:ej;if(!en||0===en.length)return"Column roles not yet configured. Please wait for analysis to complete.";let t=en.filter(e=>"Input"===e.userRole||"Model Output"===e.userRole);if(0===t.length)return"No input or model output columns identified. Please set at least one column as 'Input' or 'Model Output' in the Configure Dataset section.";let s=(v-1)%e.length,r=e[s];if(!r)return"No content available for this item.";return t.map(e=>({name:e.name,content:r[e.name]||"No content available",type:e.userRole}))}catch(e){return console.error("Error in getInputColumnContent:",e),"Error loading content. Please refresh the page."}};return(0,r.jsxs)(g.A,{title:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("input",{type:"text",value:Z,onChange:e=>{X(e.target.value),ee(!0)},className:"bg-transparent border-none text-2xl font-semibold text-gray-900 focus:outline-none focus:ring-0 p-0 m-0 min-w-0 flex-1"}),(0,r.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-gray-100 text-gray-700 flex-shrink-0",children:"Draft"})]}),actions:(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsxs)("button",{onClick:()=>q(!0),className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[(0,r.jsx)(o,{className:"h-4 w-4 mr-2"}),"Configure Dataset"]}),(0,r.jsxs)("button",{onClick:()=>W(!D),className:"inline-flex items-center px-4 py-2 border ".concat(D?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 bg-white text-gray-700"," shadow-sm text-sm font-medium rounded-md hover:bg-gray-50 focus:outline-none transition-colors"),"aria-label":D?"Hide instructions":"Show instructions",title:"Toggle instructions",children:[(0,r.jsx)("svg",{className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Instructions"]}),(0,r.jsx)("button",{onClick:()=>e.push("/data-scientist"),className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Cancel"}),(0,r.jsx)("button",{onClick:eq,disabled:F,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white ".concat(F?"bg-gray-400 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"),children:F?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save"})]}),children:[R&&(0,r.jsx)("div",{className:"mb-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(l.A,{className:"h-5 w-5 text-yellow-600 mr-3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-yellow-900",children:"Azure OpenAI Analysis Issue"}),(0,r.jsxs)("p",{className:"text-sm text-yellow-700",children:[R," Using fallback analysis instead."]})]})]})}),(0,r.jsxs)("div",{ref:U,className:"relative flex animate-in fade-in slide-in-from-bottom-4 duration-700",style:{cursor:T?"col-resize":"default"},children:[(0,r.jsxs)("div",{className:"space-y-6 pr-4",style:{width:"".concat(B,"%")},children:[(0,r.jsx)("div",{className:"bg-white shadow sm:rounded-lg",children:(0,r.jsx)("div",{className:"px-4 py-5 sm:p-6",children:(()=>{let e=eW();return"string"==typeof e?(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)(p.A,{content:e})}):Array.isArray(e)?(0,r.jsx)("div",{className:"space-y-4 mb-4",children:e.map((e,t)=>(0,r.jsx)(p.A,{content:e.content,title:eN(e.name)},t))}):null})()})}),en.filter(e=>"Metadata"===e.userRole).length>0&&(0,r.jsx)("div",{className:"bg-white shadow sm:rounded-lg",children:(0,r.jsx)("div",{className:"px-4 py-5 sm:p-6",children:(0,r.jsx)("div",{className:"space-y-2 text-xs",children:en.filter(e=>"Metadata"===e.userRole).slice(0,4).map(e=>{var t;let s=Y.length>0?Y:ej,a=(null===(t=s[(v-1)%s.length])||void 0===t?void 0:t[e.name])||"N/A";return(0,r.jsxs)("div",{children:[(0,r.jsxs)("span",{className:"font-medium text-gray-600",children:[eN(e.name),":"]}),(0,r.jsx)("span",{className:"ml-2 text-gray-900",children:String(a)})]},e.name)})})})})]}),(0,r.jsx)("div",{className:"relative group",style:{cursor:"col-resize"},children:(0,r.jsx)("div",{className:"absolute inset-y-0 w-4 -left-2 flex items-center justify-center cursor-col-resize",onMouseDown:e=>{e.preventDefault(),Q(!0)},children:(0,r.jsx)("div",{className:"h-full w-1 bg-transparent group-hover:bg-indigo-400 transition-colors duration-200",style:{backgroundColor:T?"rgb(79 70 229)":""}})})}),(0,r.jsxs)("div",{className:"pl-4",style:{width:"".concat(100-B,"%")},children:[D&&(0,r.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg mb-6 animate-in fade-in slide-in-from-top-4 duration-300",children:(0,r.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,r.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,r.jsx)("h3",{className:"text-lg leading-6 font-medium text-blue-900",children:"Instructions"})}),(0,r.jsx)("textarea",{value:et,onChange:e=>es(e.target.value),className:"w-full text-sm text-blue-800 bg-transparent border border-blue-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",rows:5})]})}),(0,r.jsx)("div",{className:"bg-white shadow sm:rounded-lg",children:(0,r.jsxs)("div",{className:"px-4 py-5 sm:p-6 relative",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Evaluation"}),(0,r.jsxs)("div",{className:"flex items-center space-x-3 flex-shrink-0 -mr-3",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{v>1&&(em(e=>({...e,[v]:j})),w(v-1))},disabled:v<=1,className:"p-1 rounded-md ".concat(v<=1?"text-gray-300 cursor-not-allowed":"text-gray-600 hover:text-gray-800 hover:bg-gray-100"),children:(0,r.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,r.jsxs)("div",{className:"flex items-center space-x-3 min-w-0",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-600 whitespace-nowrap flex-shrink-0",children:[v," of ",eD()]}),(()=>{let e=0===eD()?0:(eh.has(v)?v:v-1)/eD()*100;return(0,r.jsx)("div",{className:"flex-1 min-w-16 bg-gray-200 rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(e,"%")}})})})()]}),(0,r.jsx)("button",{type:"button",onClick:()=>{v<eD()&&v<eg&&(em(e=>({...e,[v]:j})),w(v+1))},disabled:v>=eD()||v>=eg,className:"p-1 rounded-md ".concat(v>=eD()||v>=eg?"text-gray-300 cursor-not-allowed":"text-gray-600 hover:text-gray-800 hover:bg-gray-100"),children:(0,r.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]}),(0,r.jsxs)("form",{onSubmit:eE,className:"space-y-6",children:[er.map(e=>{var t,s;return(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 group",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:[e.name,e.required&&(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]})}),(0,r.jsxs)("div",{className:"flex space-x-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,r.jsx)("button",{type:"button",onClick:()=>eA(e.id,"up"),disabled:0===er.findIndex(t=>t.id===e.id),className:"p-1 rounded-md hover:bg-gray-100 ".concat(0===er.findIndex(t=>t.id===e.id)?"text-gray-300 cursor-not-allowed":"text-gray-600 hover:text-gray-800"),"aria-label":"Move question up",children:(0,r.jsx)(i,{className:"h-4 w-4"})}),(0,r.jsx)("button",{type:"button",onClick:()=>eA(e.id,"down"),disabled:er.findIndex(t=>t.id===e.id)===er.length-1,className:"p-1 rounded-md hover:bg-gray-100 ".concat(er.findIndex(t=>t.id===e.id)===er.length-1?"text-gray-300 cursor-not-allowed":"text-gray-600 hover:text-gray-800"),"aria-label":"Move question down",children:(0,r.jsx)(d,{className:"h-4 w-4"})}),(0,r.jsx)("button",{type:"button",onClick:()=>eO(e.id),className:"text-indigo-600 hover:text-indigo-800 p-1 rounded-md hover:bg-gray-100 border border-gray-200","aria-label":"Edit question",children:(0,r.jsx)(c,{className:"h-4 w-4"})}),er.length>1&&(0,r.jsx)("button",{type:"button",onClick:()=>eR(e.id),className:"text-red-600 hover:text-red-800 p-1 rounded-md hover:bg-gray-100 border border-gray-200","aria-label":"Delete question",children:(0,r.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),"yes-no"===e.type&&(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:e.options.map((t,s)=>(0,r.jsx)("button",{type:"button",onClick:()=>eL(e.id,t),className:"px-3 py-1.5 text-sm font-medium rounded-md border transition-colors ".concat(j["criterion-".concat(e.id)]===t?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),children:t},s))}),"likert-scale"===e.type&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("span",{className:"text-xs text-gray-500",children:(null===(t=e.likertLabels)||void 0===t?void 0:t.low)||"Low"}),(0,r.jsx)("span",{className:"text-xs text-gray-500",children:(null===(s=e.likertLabels)||void 0===s?void 0:s.high)||"High"})]}),(0,r.jsx)("div",{className:"grid grid-cols-5 gap-2",children:[1,2,3,4,5].map(t=>(0,r.jsx)("button",{type:"button",onClick:()=>eL(e.id,t.toString()),className:"px-3 py-1.5 text-sm font-medium rounded-md border transition-colors ".concat(j["criterion-".concat(e.id)]===t.toString()?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),children:t},t))})]}),"custom-list"===e.type&&(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:e.options.map((t,s)=>(0,r.jsx)("button",{type:"button",onClick:()=>eL(e.id,t),className:"px-3 py-1.5 text-sm font-medium rounded-md border transition-colors ".concat(j["criterion-".concat(e.id)]===t?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),children:t},s))}),"text-input"===e.type&&(0,r.jsx)("textarea",{rows:3,value:j["criterion-".concat(e.id)]||"",onChange:t=>eL(e.id,t.target.value),className:"block w-full border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm px-3 py-1.5",placeholder:"Enter ".concat(e.name.toLowerCase(),"...")})]},e.id)}),(0,r.jsxs)("button",{type:"button",onClick:()=>{E({id:er.length>0?Math.max(...er.map(e=>e.id))+1:1,name:"New Metric",type:"yes-no",options:["Yes","No"],required:!1}),M(!0)},className:"w-full border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-gray-400 transition-colors",children:[(0,r.jsx)(u,{className:"h-6 w-6 text-gray-400 mx-auto mb-2"}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Add a Question"})]}),(0,r.jsx)("div",{className:"pt-4",children:(()=>{let e=eh.has(v),t=eC&&(!e||eb);return(0,r.jsx)("button",{type:"submit",disabled:!t||k,className:"w-full inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white ".concat(t&&!k?"bg-blue-500 hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500":"bg-gray-400 cursor-not-allowed"),children:k?(0,r.jsxs)(r.Fragment,{children:["Submit",(0,r.jsxs)("svg",{className:"ml-2 h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})]}):ef&&!eb?"Review Complete":(0,r.jsxs)(r.Fragment,{children:["Submit",(0,r.jsx)(m.A,{className:"ml-2 h-4 w-4"})]})})})()})]})]})})]})]}),A&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>q(!1)}),(0,r.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-7xl sm:w-full",children:[(0,r.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,r.jsx)("div",{className:"flex items-center justify-between mb-5",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-2.5",children:"Configure Dataset"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"The system has preselected columns for evaluation. You may adjust selections and their UI-visible labels as needed."})]})}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)("div",{className:"border border-gray-200 rounded-lg overflow-auto max-h-[32rem]",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsxs)("thead",{children:[(0,r.jsx)("tr",{className:"bg-gray-50",children:(Y.length>0?K:Object.keys(ej[0])).map(e=>{let t=en.find(t=>t.name===e);return(0,r.jsx)("th",{className:"px-6 py-3 text-left",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("select",{value:(null==t?void 0:t.userRole)||(null==t?void 0:t.suggestedRole)||"Metadata",onChange:t=>eM(e,t.target.value),className:"block w-48 px-3 py-1.5 text-sm font-medium rounded-md border border-gray-300 shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[(0,r.jsx)("option",{value:"Input",children:"Input (Prompt)"}),(0,r.jsx)("option",{value:"Model Output",children:"Output (Completion)"}),(0,r.jsx)("option",{value:"Reference",children:"Reference"}),(0,r.jsx)("option",{value:"Metadata",children:"Metadata"}),(0,r.jsx)("option",{value:"Excluded",children:"Excluded"})]}),(0,r.jsx)("div",{className:"ml-1 relative",children:(0,r.jsxs)("div",{className:"group",children:[(0,r.jsx)("svg",{className:"h-4 w-4 text-gray-400 cursor-help",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsxs)("div",{className:"absolute top-full mt-2 w-64 bg-gray-900 text-white text-xs rounded-lg p-3 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none z-[100] ".concat(e===(Y.length>0?K:Object.keys(ej[0]))[0]?"left-0":e===(Y.length>0?K:Object.keys(ej[0]))[(Y.length>0?K:Object.keys(ej[0])).length-1]?"right-0":"left-1/2 transform -translate-x-1/2"),children:[(0,r.jsx)("div",{className:"font-medium mb-1",children:(()=>{let e=(null==t?void 0:t.userRole)||(null==t?void 0:t.suggestedRole)||"Metadata";return"Input"===e||"Input Data"===e?"Input (Prompt)":"Model Output"===e?"Output (Completion)":e})()}),(0,r.jsx)("div",{className:"text-gray-300 font-normal",children:(null==t?void 0:t.userRole)==="Excluded"?"".concat((null==t?void 0:t.reason)||"No analysis available for this column",". This data may not be needed for the evaluation."):(null==t?void 0:t.reason)||"No analysis available for this column"}),(0,r.jsx)("div",{className:"absolute bottom-full border-4 border-transparent border-b-gray-900 ".concat(e===(Y.length>0?K:Object.keys(ej[0]))[0]?"left-4":e===(Y.length>0?K:Object.keys(ej[0]))[(Y.length>0?K:Object.keys(ej[0])).length-1]?"right-4":"left-1/2 transform -translate-x-1/2")})]})]})})]})},e)})}),(0,r.jsx)("tr",{className:"bg-blue-50",children:(Y.length>0?K:Object.keys(ej[0])).map(e=>{let t=en.find(t=>t.name===e);return(0,r.jsx)("th",{className:"px-6 pt-3 pb-2 text-left",children:(0,r.jsx)("input",{type:"text",placeholder:"UI-Visible Label",value:(null==t?void 0:t.displayName)||"",onChange:t=>eI(e,t.target.value),className:"block w-48 px-3 py-1.5 text-sm font-semibold rounded-md border border-gray-300 shadow-sm text-gray-700 bg-white placeholder-gray-400 placeholder:font-normal focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 focus:border-indigo-500"})},e)})}),(0,r.jsx)("tr",{className:"bg-blue-50",children:(Y.length>0?K:Object.keys(ej[0])).map(e=>(en.find(t=>t.name===e),(0,r.jsx)("th",{className:"px-6 py-2 text-left text-sm font-semibold text-gray-900",children:e},e)))})]}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:(Y.length>0?Y.slice(0,5):ej).map((e,t)=>(0,r.jsx)("tr",{className:"hover:bg-gray-50",children:Object.entries(e).map((e,t)=>{let[s,a]=e;return(0,r.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900",children:String(a)},t)})},t))})]})})})]}),(0,r.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,r.jsx)("button",{onClick:()=>q(!1),className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Save"}),(0,r.jsx)("button",{onClick:()=>q(!1),className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})}),(0,r.jsx)(h,{metric:C,metrics:er,isOpen:L,onClose:()=>{M(!1),E(null)},onSave:e=>{er.findIndex(t=>t.id===e.id)>=0?ea(er.map(t=>t.id===e.id?e:t)):ea([...er,e]),M(!1),E(null)}})]})}},4500:(e,t,s)=>{s.d(t,{A:()=>a});var r=s(2115);let a=r.forwardRef(function(e,t){let{title:s,titleId:a,...n}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),s?r.createElement("title",{id:a},s):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))})},4958:(e,t,s)=>{async function r(){console.log("Client: Fetching evaluations from localStorage");try{let e=JSON.parse(localStorage.getItem("evaluations")||"[]");console.log("Client: Found ".concat(e.length," evaluations in localStorage"));let t=new Set,s=e.filter(e=>t.has(e.id)?(console.log("Duplicate ID found: ".concat(e.id,", filtering out duplicate")),!1):(t.add(e.id),!0));return s.length<e.length&&(console.log("Filtered out ".concat(e.length-s.length," duplicate evaluation(s)")),localStorage.setItem("evaluations",JSON.stringify(s))),s.map(e=>(e.toJSON||(e.toJSON=function(){return this}),e))}catch(e){return console.error("Error fetching evaluations from localStorage:",e),[]}}async function a(e){try{console.log("Client: Creating evaluation in localStorage",e.name);let t=JSON.parse(localStorage.getItem("evaluations")||"[]");e.id&&t.some(t=>t.id===e.id)&&(console.log("Warning: Evaluation with ID ".concat(e.id," already exists. Generating new ID.")),e.id=Date.now()),t.unshift(e),localStorage.setItem("evaluations",JSON.stringify(t)),console.log("Client: Successfully created evaluation in localStorage");let s={...e};return s.toJSON||(s.toJSON=function(){return this}),s}catch(e){throw console.error("Error creating evaluation in localStorage:",e),Error("Failed to create evaluation: ".concat(e.message||String(e)))}}async function n(e){try{console.log("Client: Deleting evaluation ".concat(e," from localStorage"));let t=JSON.parse(localStorage.getItem("evaluations")||"[]").filter(t=>t.id!==e);return localStorage.setItem("evaluations",JSON.stringify(t)),console.log("Client: Successfully deleted evaluation from localStorage"),!0}catch(t){throw console.error("Error deleting evaluation ".concat(e," from localStorage:"),t),Error("Failed to delete evaluation: ".concat(t.message||String(t)))}}s.d(t,{Hg:()=>a,Iw:()=>r,am:()=>n})},5628:(e,t,s)=>{s.d(t,{A:()=>a});var r=s(2115);let a=r.forwardRef(function(e,t){let{title:s,titleId:a,...n}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),s?r.createElement("title",{id:a},s):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))})},7489:(e,t,s)=>{s.d(t,{A:()=>d});var r=s(5155),a=s(2115),n=s(5628);let o=a.forwardRef(function(e,t){let{title:s,titleId:r,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},n),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"}))});function l(e){let{url:t,title:s,className:l=""}=e,[i,d]=(0,a.useState)(!1),[c,u]=(0,a.useState)(!0);if(!([".mp4",".webm",".ogg",".mov",".avi",".mkv",".flv"].some(e=>t.toLowerCase().includes(e))||["youtube.com","youtu.be","vimeo.com"].some(e=>t.toLowerCase().includes(e))))return(0,r.jsx)("div",{className:"text-sm text-gray-900 ".concat(l),children:t});if(i)return(0,r.jsxs)("div",{className:"border border-gray-300 rounded-lg p-4 bg-gray-50 ".concat(l),children:[(0,r.jsxs)("div",{className:"flex items-center text-red-600",children:[(0,r.jsx)(n.A,{className:"h-5 w-5 mr-2"}),(0,r.jsx)("span",{className:"text-sm",children:"Failed to load video"})]}),(0,r.jsx)("div",{className:"mt-2 text-xs text-gray-600",children:(0,r.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Open video in new tab"})})]});let m=(e=>{for(let t of[/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/,/youtube\.com\/watch\?.*v=([^&\n?#]+)/]){let s=e.match(t);if(s)return s[1]}return null})(t);if(m)return(0,r.jsxs)("div",{className:"relative ".concat(l),children:[(0,r.jsx)("iframe",{src:"https://www.youtube.com/embed/".concat(m,"?rel=0"),title:s||"YouTube video",className:"w-full aspect-video rounded-lg",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,onLoad:()=>u(!1),onError:()=>d(!0)}),c&&(0,r.jsx)("div",{className:"absolute inset-0 bg-gray-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})})]});let g=(e=>{let t=e.match(/vimeo\.com\/(\d+)/);return t?t[1]:null})(t);return g?(0,r.jsxs)("div",{className:"relative ".concat(l),children:[(0,r.jsx)("iframe",{src:"https://player.vimeo.com/video/".concat(g),title:s||"Vimeo video",className:"w-full aspect-video rounded-lg",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0,onLoad:()=>u(!1),onError:()=>d(!0)}),c&&(0,r.jsx)("div",{className:"absolute inset-0 bg-gray-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})})]}):(0,r.jsxs)("div",{className:"relative ".concat(l),children:[(0,r.jsxs)("video",{controls:!0,className:"w-full max-h-96 rounded-lg",onLoadStart:()=>u(!0),onLoadedData:()=>u(!1),onError:()=>d(!0),crossOrigin:"anonymous",children:[(0,r.jsx)("source",{src:t}),"Your browser does not support the video tag."]}),c&&(0,r.jsx)("div",{className:"absolute inset-0 bg-gray-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)(o,{className:"h-12 w-12 text-gray-400"})})]})}function i(e){let{url:t,title:s,className:o=""}=e,[l,i]=(0,a.useState)(!1),[d,c]=(0,a.useState)(!0);return(e=>{let t=e.toLowerCase();return[".jpg",".jpeg",".png",".gif",".webp",".svg",".bmp",".ico",".tiff"].some(e=>t.includes(e))||["imgur.com","i.imgur.com","images.unsplash.com","unsplash.com","pixabay.com","pexels.com","flickr.com","instagram.com","pinterest.com","googleusercontent.com","amazonaws.com","cloudinary.com","imagekit.io"].some(e=>t.includes(e))||t.includes("image")||t.includes("photo")||t.includes("picture")})(t)?l?(0,r.jsxs)("div",{className:"border border-gray-300 rounded-lg p-4 bg-gray-50 ".concat(o),children:[(0,r.jsxs)("div",{className:"flex items-center text-red-600",children:[(0,r.jsx)(n.A,{className:"h-5 w-5 mr-2"}),(0,r.jsx)("span",{className:"text-sm",children:"Failed to load image"})]}),(0,r.jsx)("div",{className:"mt-2 text-xs text-gray-600",children:(0,r.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Open image in new tab"})}),(0,r.jsx)("button",{onClick:()=>{i(!1),c(!0)},className:"mt-2 text-xs text-blue-600 hover:underline",children:"Retry loading"})]}):(0,r.jsxs)("div",{className:"relative flex justify-center ".concat(o),children:[d&&(0,r.jsx)("div",{className:"absolute inset-0 bg-gray-100 rounded-lg flex items-center justify-center min-h-[200px]",children:(0,r.jsxs)("div",{className:"flex flex-col items-center space-y-2",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"}),(0,r.jsx)("span",{className:"text-sm text-gray-500",children:"Loading image..."})]})}),(0,r.jsx)("img",{src:t||"/placeholder.svg",alt:s||"Content image",className:"max-w-full h-auto rounded-lg shadow-sm ".concat(d?"opacity-0":"opacity-100"," transition-opacity duration-300"),style:{maxHeight:"500px"},onLoad:()=>c(!1),onError:()=>{i(!0),c(!1)}})]}):(0,r.jsx)("div",{className:"text-sm text-gray-900 ".concat(o),children:t})}function d(e){let{content:t,title:s,className:a=""}=e;if((e=>{try{return new URL(e.trim()),!0}catch(e){return!1}})(t)){let e=t.trim();return[".mp4",".webm",".ogg",".mov",".avi",".mkv",".flv"].some(t=>e.toLowerCase().includes(t))||["youtube.com","youtu.be","vimeo.com"].some(t=>e.toLowerCase().includes(t))?(0,r.jsxs)("div",{className:a,children:[s&&(0,r.jsx)("div",{className:"text-xs font-medium text-gray-600 mb-2",children:s}),(0,r.jsx)(l,{url:e,title:s})]}):(e=>{let t=e.toLowerCase();return[".jpg",".jpeg",".png",".gif",".webp",".svg",".bmp",".ico",".tiff"].some(e=>t.includes(e))||["imgur.com","i.imgur.com","images.unsplash.com","unsplash.com","pixabay.com","pexels.com","flickr.com","instagram.com","pinterest.com","googleusercontent.com","amazonaws.com","cloudinary.com","imagekit.io"].some(e=>t.includes(e))})(e)?(0,r.jsxs)("div",{className:a,children:[s&&(0,r.jsx)("div",{className:"text-xs font-medium text-gray-600 mb-2",children:s}),(0,r.jsx)(i,{url:e,title:s})]}):(0,r.jsxs)("div",{className:a,children:[s&&(0,r.jsx)("div",{className:"text-xs font-medium text-gray-600 mb-2",children:s}),(0,r.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline text-sm break-all",children:e})]})}return(0,r.jsxs)("div",{className:a,children:[s&&(0,r.jsx)("div",{className:"text-xs font-medium text-gray-600 mb-2",children:s}),(0,r.jsx)("p",{className:"text-sm text-gray-900 leading-relaxed",children:t})]})}},9416:(e,t,s)=>{s.d(t,{A:()=>a});var r=s(2115);let a=r.forwardRef(function(e,t){let{title:s,titleId:a,...n}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),s?r.createElement("title",{id:a},s):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"}))})}}]);